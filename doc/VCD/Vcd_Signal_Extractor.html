<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: VCD::Vcd_Signal_Extractor
  
    &mdash; Documentation by YARD 0.9.34
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "VCD::Vcd_Signal_Extractor";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (V)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../VCD.html" title="VCD (module)">VCD</a></span></span>
     &raquo; 
    <span class="title">Vcd_Signal_Extractor</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: VCD::Vcd_Signal_Extractor
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">VCD::Vcd_Signal_Extractor</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/vcd_tools/vcd_signal_extractor.rb<span class="defines">,<br />
  lib/vcd_tools/vcd_signal_extractor2.rb</span>
</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#id_tab-instance_method" title="#id_tab (instance method)">#<strong>id_tab</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute id_tab.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_output_event-instance_method" title="#add_output_event (instance method)">#<strong>add_output_event</strong>(signal, val)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>: Add last event just encountered to concerned signal.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extract-instance_method" title="#extract (instance method)">#<strong>extract</strong>(path, compiler, signals = :outputs_only)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>: Start the extraction, kind of the FSM controler.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_clock_period-instance_method" title="#get_clock_period (instance method)">#<strong>get_clock_period</strong>(path, clk_name = &quot;obs_clk&quot;)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_last_timestamp-instance_method" title="#get_last_timestamp (instance method)">#<strong>get_last_timestamp</strong>(path)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; Vcd_Signal_Extractor </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of Vcd_Signal_Extractor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#load_vcd-instance_method" title="#load_vcd (instance method)">#<strong>load_vcd</strong>(path, start = 0)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#next_output-instance_method" title="#next_output (instance method)">#<strong>next_output</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>: Retrieve the next element in the vcd attribute (vcd file) and delete it of the array.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_traces-instance_method" title="#save_traces (instance method)">#<strong>save_traces</strong>(path)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#selected_traces_extraction-instance_method" title="#selected_traces_extraction (instance method)">#<strong>selected_traces_extraction</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#traces_definition-instance_method" title="#traces_definition (instance method)">#<strong>traces_definition</strong>(path, compiler, opt = :outputs_only)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>: Defines traces to follow and their identifier in the vcd file (header data extraction).</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#traces_definition_output_only-instance_method" title="#traces_definition_output_only (instance method)">#<strong>traces_definition_output_only</strong>(path, compiler)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#traces_definition_signal_list-instance_method" title="#traces_definition_signal_list (instance method)">#<strong>traces_definition_signal_list</strong>(path, compiler, opt)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_timestamp-instance_method" title="#update_timestamp (instance method)">#<strong>update_timestamp</strong>(timestamp)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><ul><li>
<p>: Update the timestamp by the last just encountered.</p>
</li></ul>
</div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="VCD::Vcd_Signal_Extractor (class)">Vcd_Signal_Extractor</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of Vcd_Signal_Extractor.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7
8
9
10</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
    <span class='ivar'>@output_traces</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@id_tab</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@vcd</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@current_timestamp</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="id_tab-instance_method">
  
    #<strong>id_tab</strong>  &#x21d2; <tt>Object</tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute id_tab.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor2.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_id_tab'>id_tab</span>
  <span class='ivar'>@id_tab</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="add_output_event-instance_method">
  
    #<strong>add_output_event</strong>(signal, val)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>: Add last event just encountered to concerned signal</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 157</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_output_event'>add_output_event</span> <span class='id identifier rubyid_signal'>signal</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span>
    <span class='ivar'>@output_traces</span><span class='lbracket'>[</span><span class='id identifier rubyid_signal'>signal</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_timestamp'>timestamp</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extract-instance_method">
  
    #<strong>extract</strong>(path, compiler, signals = :outputs_only)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>: Start the extraction, kind of the FSM controler</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19
20
21
22
23
24
25
26</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 17</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extract'>extract</span> <span class='id identifier rubyid_compiler'>compiler</span><span class='comma'>,</span> <span class='id identifier rubyid_signals'>signals</span> <span class='op'>=</span> <span class='symbol'>:outputs_only</span>
    <span class='kw'>if</span> <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error : A VCD file must be loaded with &#39;load_vcd()&#39; first.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_traces_definition'>traces_definition</span> <span class='id identifier rubyid_compiler'>compiler</span><span class='comma'>,</span> <span class='id identifier rubyid_signals'>signals</span>
    <span class='id identifier rubyid_selected_traces_extraction'>selected_traces_extraction</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span>    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>output_traces</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@output_traces</span><span class='comma'>,</span> 
                <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id_tab</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id_tab</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_clock_period-instance_method">
  
    #<strong>get_clock_period</strong>(path, clk_name = &quot;obs_clk&quot;)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 90</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_clock_period'>get_clock_period</span> <span class='id identifier rubyid_clk_name'>clk_name</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>obs_clk</span><span class='tstring_end'>&quot;</span></span>
    <span class='comment'># * : Returns the clock period for the given vcd file (by default the OBSERVATION clock named &#39;obs_clk&#39;)
</span>    <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_clk_name'>clk_name</span>
            <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span>
            <span class='kw'>break</span>
        <span class='kw'>else</span>
            <span class='kw'>next</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_bounds'>bounds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='id identifier rubyid_events_line'>events_line</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$enddefinitions $end</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>break</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_events_line'>events_line</span> <span class='op'>+=</span> <span class='int'>1</span>
            <span class='kw'>next</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_last_timestamp'>last_timestamp</span> <span class='op'>=</span> <span class='int'>0</span>

    <span class='comment'># * Reuse the line splitted version of the file
</span>    <span class='ivar'>@vcd</span><span class='lbracket'>[</span><span class='id identifier rubyid_events_line'>events_line</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_bounds'>bounds</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>2</span>
            <span class='comment'># * Compute the clk period as 2x the second timestamp value
</span>            <span class='kw'>return</span> <span class='id identifier rubyid_bounds'>bounds</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='op'>*</span><span class='int'>2</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='op'>==</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span>
            <span class='comment'># * Memorize the last encountered timestamp (0 as the first) 
</span>            <span class='comment'># * When found memorize the timestamp 
</span>            <span class='id identifier rubyid_last_timestamp'>last_timestamp</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_delete_prefix'>delete_prefix</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span> <span class='kw'>and</span> <span class='lparen'>(</span><span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&lt;</span> <span class='int'>3</span><span class='rparen'>)</span> <span class='comment'># We know the clock is always in the first symbol attribution so its ID is only one symbol long 
</span>            <span class='comment'># * Check if the ID has an event in this timestamp until it is another timestamp, then update the last uncountered timestamp
</span>            <span class='id identifier rubyid_bounds'>bounds</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_last_timestamp'>last_timestamp</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='comment'># * When 2 timestamp are found by this way (first should be 0, second is half the period) 
</span>        <span class='kw'>else</span>
            <span class='kw'>next</span>
        <span class='kw'>end</span>
        
    <span class='kw'>end</span>
    
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_last_timestamp-instance_method">
  
    #<strong>get_last_timestamp</strong>(path)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82
83
84
85
86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_last_timestamp'>get_last_timestamp</span>
    <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_reverse_each'>reverse_each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span>
            <span class='kw'>return</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_delete_prefix'>delete_prefix</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='kw'>end</span> 
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error: clock not found</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="load_vcd-instance_method">
  
    #<strong>load_vcd</strong>(path, start = 0)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


12
13
14</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 12</span>

<span class='kw'>def</span> <span class='id identifier rubyid_load_vcd'>load_vcd</span> <span class='id identifier rubyid_path'>path</span>
    <span class='ivar'>@vcd</span> <span class='op'>=</span> <span class='const'>IO</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="next_output-instance_method">
  
    #<strong>next_output</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>: Retrieve the next element in the vcd attribute (vcd file) and delete it of the array</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_next_output'>next_output</span>
    <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save_traces-instance_method">
  
    #<strong>save_traces</strong>(path)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


137
138
139
140
141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 137</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_traces'>save_traces</span> <span class='id identifier rubyid_path'>path</span>
    <span class='comment'># * : Saves the required data for comparison as wrapped in a Hash object
</span>    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_write'>write</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='const'>Marshal</span><span class='period'>.</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span><span class='lbrace'>{</span> 
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>output_traces</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@output_traces</span><span class='comma'>,</span> 
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id_tab</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@id_tab</span><span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="selected_traces_extraction-instance_method">
  
    #<strong>selected_traces_extraction</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_selected_traces_extraction'>selected_traces_extraction</span>
    <span class='ivar'>@output_traces</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='comment'># * Only keeps the output signals
</span>    <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_next_output'>next_output</span> <span class='comment'># init
</span>
    <span class='kw'>until</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span> <span class='comment'># * : new timestamp detected, update it
</span>            <span class='id identifier rubyid_update_timestamp'>update_timestamp</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_delete_prefix'>delete_prefix</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>#</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='comment'># * : Unexpected syntax are covered by the raise in the next conditionnal branchement
</span>        <span class='kw'>else</span>
            <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>1</span><span class='op'>..</span><span class='rbracket'>]</span>
            <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
                <span class='id identifier rubyid_id'>id</span> <span class='op'>=</span> <span class='id identifier rubyid_id'>id</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
                <span class='ivar'>@output_traces</span><span class='lbracket'>[</span><span class='ivar'>@current_timestamp</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span>
            <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_next_output'>next_output</span>
    <span class='kw'>end</span>

    <span class='ivar'>@output_traces</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='comma'>,</span><span class='id identifier rubyid_val'>val</span><span class='op'>|</span> <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='kw'>then</span> <span class='ivar'>@output_traces</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span><span class='id identifier rubyid_key'>key</span><span class='rparen'>)</span> <span class='kw'>end</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="traces_definition-instance_method">
  
    #<strong>traces_definition</strong>(path, compiler, opt = :outputs_only)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>: Defines traces to follow and their identifier in the vcd file (header data extraction)</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_traces_definition'>traces_definition</span> <span class='id identifier rubyid_compiler'>compiler</span><span class='comma'>,</span> <span class='id identifier rubyid_opt'>opt</span><span class='op'>=</span><span class='symbol'>:outputs_only</span>
    <span class='ivar'>@vcd</span><span class='period'>.</span><span class='id identifier rubyid_shift'>shift</span><span class='lparen'>(</span><span class='int'>8</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_next_output'>next_output</span>
    <span class='id identifier rubyid_data_type'>data_type</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_compiler'>compiler</span> <span class='op'>==</span> <span class='symbol'>:nvc</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logic</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reg</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_opt'>opt</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Array</span> <span class='comment'># * &#39;opt&#39; is a list of signals to monitor
</span>        <span class='kw'>until</span> <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$enddefinitions $end</span><span class='tstring_end'>&quot;</span></span> 
            <span class='kw'>if</span> <span class='id identifier rubyid_opt'>opt</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> 
                <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span>
                <span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='comment'># * : The original signal name (tmp[4]) is associated to VCD ID (tmp[3]).
</span>            <span class='kw'>end</span>
            <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_next_output'>next_output</span>
        <span class='kw'>end</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_opt'>opt</span> <span class='op'>==</span> <span class='symbol'>:outputs_only</span>
        <span class='kw'>until</span> <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$enddefinitions $end</span><span class='tstring_end'>&quot;</span></span> 
            <span class='kw'>if</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\$var </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data_type'>data_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> [0-9]+ .+ tb_o[0-9]+_s .+</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> <span class='comment'># ! : Not really optimized, certainly could be improved
</span>                <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span>
                <span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_tmp'>tmp</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='comment'># * : The original signal name (tmp[4]) is associated to VCD ID (tmp[3]).
</span>            <span class='kw'>end</span>
            <span class='id identifier rubyid_tmp'>tmp</span> <span class='op'>=</span> <span class='id identifier rubyid_next_output'>next_output</span>
        <span class='kw'>end</span>
    <span class='kw'>else</span> <span class='comment'># :all_sig for example
</span>        <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error : Functionnality not available yet ! WIP</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="traces_definition_output_only-instance_method">
  
    #<strong>traces_definition_output_only</strong>(path, compiler)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor2.rb', line 88</span>

<span class='kw'>def</span> <span class='id identifier rubyid_traces_definition_output_only'>traces_definition_output_only</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_compiler'>compiler</span>
    <span class='id identifier rubyid_data_type'>data_type</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_compiler'>compiler</span> <span class='op'>==</span> <span class='symbol'>:nvc</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>logic</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>reg</span><span class='tstring_end'>&quot;</span></span><span class='semicolon'>;</span>

    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with_index'>with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='comment'># tmp = next_output
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$enddefinitions $end\n</span><span class='tstring_end'>&quot;</span></span> 
            <span class='kw'>return</span> <span class='id identifier rubyid_i'>i</span>
        <span class='kw'>else</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_match?'>match?</span><span class='lparen'>(</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\$var </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_data_type'>data_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> [0-9]+ .+ tb_o[0-9]+_s .+</span><span class='regexp_end'>/</span></span><span class='rparen'>)</span> <span class='comment'># ! : Not really optimized, certainly could be improved
</span>                <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span>
                <span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='comment'># * : The original signal name (line[4]) is associated to VCD ID (line[3]).
</span>            <span class='kw'>end</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error : VCD definition end not found.</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="traces_definition_signal_list-instance_method">
  
    #<strong>traces_definition_signal_list</strong>(path, compiler, opt)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108
109
110
111
112
113
114
115
116
117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor2.rb', line 106</span>

<span class='kw'>def</span> <span class='id identifier rubyid_traces_definition_signal_list'>traces_definition_signal_list</span> <span class='id identifier rubyid_path'>path</span><span class='comma'>,</span> <span class='id identifier rubyid_compiler'>compiler</span><span class='comma'>,</span> <span class='id identifier rubyid_opt'>opt</span>

    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_foreach'>foreach</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_with_index'>with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='comma'>,</span> <span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
        <span class='comment'># tmp = next_output
</span>        <span class='kw'>if</span> <span class='id identifier rubyid_line'>line</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$enddefinitions $end\n</span><span class='tstring_end'>&quot;</span></span> 
            <span class='kw'>return</span> <span class='id identifier rubyid_i'>i</span>
        <span class='kw'>else</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_opt'>opt</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> 
                <span class='id identifier rubyid_line'>line</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span>
                <span class='ivar'>@id_tab</span><span class='lbracket'>[</span><span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='lbracket'>[</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='comment'># * : The original signal name (line[4]) is associated to VCD ID (line[3]).
</span>            <span class='kw'>end</span>    
        <span class='kw'>end</span>
    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_timestamp-instance_method">
  
    #<strong>update_timestamp</strong>(timestamp)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <ul><li>
<p>: Update the timestamp by the last just encountered</p>
</li></ul>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/vcd_tools/vcd_signal_extractor.rb', line 146</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_timestamp'>update_timestamp</span> <span class='id identifier rubyid_timestamp'>timestamp</span>
    <span class='ivar'>@current_timestamp</span> <span class='op'>=</span> <span class='id identifier rubyid_timestamp'>timestamp</span>
    <span class='ivar'>@output_traces</span><span class='lbracket'>[</span><span class='ivar'>@current_timestamp</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Wed Apr 17 16:20:28 2024 by
  <a href="https://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.34 (ruby-3.1.2).
</div>

    </div>
  </body>
</html>